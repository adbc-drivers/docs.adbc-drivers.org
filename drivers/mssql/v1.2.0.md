---
# Copyright (c) 2025 Columnar Technologies Inc.  All rights reserved.
{}
---

(driver-mssql-v1.2.0)=
# Microsoft SQL Server Driver v1.2.0

:::{note}
This project is not associated with Microsoft.
:::

[{badge-primary}`Driver Version|v1.2.0`](#driver-mssql-v1.2.0 "Permalink") {badge-success}`Tested With|Microsoft SQL Server 2022`

This driver provides access to [Microsoft SQL Server][mssql].

## Installation & Quickstart

The driver can be installed with [dbc](https://docs.columnar.tech/dbc):

```bash
dbc install mssql
```

## Connecting

To use the driver, provide a SQL Server connection string as the `uri` option. The driver supports URI format and DSN-style connection strings, but URIs are recommended.

```python
from adbc_driver_manager import dbapi

dbapi.connect(
  driver="mssql",
  db_kwargs={
      "uri": "mssql://sa:password@localhost:1433"
  }
)
```

Note: The example above is for Python using the [adbc-driver-manager](https://pypi.org/project/adbc-driver-manager) package but the process will be similar for other driver managers.  See [adbc-quickstarts](https://github.com/columnar-tech/adbc-quickstarts).

### Connection String Format

SQL Server URI syntax:

```
mssql://[user:[password]]@host[:port][/instance][?param1=value&param2=value]

sqlserver://[user:[password]]@host[:port][/instance][?param1=value&param2=value]
```

This follows the format of [Microsoft's official Go MSSQL driver](https://github.com/microsoft/go-mssqldb/tree/main?tab=readme-ov-file#the-connection-string-can-be-specified-in-one-of-three-formats).

Components:

- `scheme`: `mssql://` or `sqlserver://` (required) - both schemes are supported
- `user/password`: (optional) Credentials for standard SQL Server authentication.
- `host`: (required) The hostname or IP address of the SQL Server machine.
- `port`: (optional) Defaults to 1433.
- `instance`: (optional) The name of the SQL Server instance (e.g., SQLExpress).
- `Query Parameters`: Additional configuration options. For a list of common parameters, see the [Microsoft's official Go MSSQL driver](https://github.com/microsoft/go-mssqldb?tab=readme-ov-file#common-parameters)

:::{note}
Reserved characters in URI elements must be URI-encoded. For example, `@` becomes `%40`.
:::

Examples:

- `mssql://username:mypass@localhost?database=master&connection+timeout=30`
- `mssql://username:mypass@localhost:1234?database=master&connection+timeout=30`
- `mssql://username@localhost/SQLExpress?database=master&connection+timeout=30`
- `sqlserver://sa@localhost/SQLExpress?database=master&connection+timeout=30`
- `sqlserver://sa:mypass@localhost?database=master&connection+timeout=30`
- `sqlserver://sa:mypass@localhost:1234?database=master&connection+timeout=30`


EntraID (Azure Active Directory) authentication is enabled by adding a `fedauth` parameter to your connection URI. For more information, see the documentation for [Microsoft's official Go MSSQL driver](https://github.com/microsoft/go-mssqldb?tab=readme-ov-file#azure-active-directory-authentication).

This driver also supports other types of connection strings that are supported by [Microsoft's official Go MSSQL driver](https://github.com/microsoft/go-mssqldb/tree/main?tab=readme-ov-file#the-connection-string-can-be-specified-in-one-of-three-formats).

## Feature & Type Support

<table class="docutils data align-default" style="width: 100%">
  <colgroup>
    <col span="1" style="width: 25%;">
    <col span="1" style="width: 25%;">
    <col span="1" style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Feature</th>
      <th colspan="2">Support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="8">Bulk Ingestion</td>
      <td>Create</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Append</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Create/Append</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Replace</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Temporary Table</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Specify target catalog</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Specify target schema</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Non-nullable fields are marked NOT NULL</td>
      <td>✅</td>
    </tr>
    <tr>
      <td rowspan="4">Catalog (GetObjects)</td>
      <td>depth=catalogs</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>depth=db_schemas</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>depth=tables</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>depth=columns (all)</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Get Parameter Schema</td>
      <td colspan="2">✅</td>
    </tr>
    <tr>
      <td>Get Table Schema</td>
      <td colspan="2">✅</td>
    </tr>
    <tr>
      <td>Prepared Statements</td>
      <td colspan="2">✅</td>
    </tr>
    <tr>
      <td>Transactions</td>
      <td colspan="2">✅</td>
    </tr>
  </tbody>
</table>


<table class="docutils data align-default" style="width: 100%">
  <colgroup>
    <col span="1" style="width: 25%;">
    <col span="1" style="width: 25%;">
    <col span="1" style="width: 10%;">
    <col span="1" style="width: 40%;">
  </colgroup>
  <thead>
    <tr>
      <th>Feature</th>
      <th>Name</th>
      <th>Support</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">Configuration</td>
      <td>Connect with URI</td>
      <td>✅</td>
      <td>Test MSSQL URI without explicit port.</td>
    </tr>
    <tr>
      <td>Connect with mssql:// URI</td>
      <td>✅</td>
      <td>Test end-to-end connection with mssql:// scheme.</td>
    </tr>
    <tr>
      <td>Connect with sqlserver:// URI</td>
      <td>✅</td>
      <td>Test end-to-end connection with sqlserver:// scheme.</td>
    </tr>
  </tbody>
</table>

### Types

#### Microsoft SQL Server to Arrow

:::{list-table}
:header-rows: 1
:width: 100%
:widths: 1 3

* - Microsoft SQL Server Type
  - Arrow Type
* - BIGINT
  - int64
* - BIT
  - bool
* - CHAR
  - string
* - DATE
  - date32[day]
* - DATETIME
  - timestamp[us] (with time zone)
* - DATETIME2
  - timestamp[us] (with time zone)
* - DOUBLE PRECISION
  - double
* - INT
  - int32
* - NCHAR
  - string
* - NUMERIC
  - decimal128
* - REAL
  - float
* - SMALLINT
  - int16
* - TIME
  - time64[ns] ⚠️ [^1]
* - TIME(0)
  - time32[s]
* - TIME(1)
  - time32[ms]
* - TIME(2)
  - time32[ms]
* - TIME(3)
  - time32[ms]
* - TIME(4)
  - time64[us]
* - TIME(5)
  - time64[us]
* - TIME(6)
  - time64[us]
* - TIME(7)
  - time64[ns]
* - VARBINARY
  - binary
* - VARCHAR
  - string
:::

#### Arrow to Microsoft SQL Server

<table class="docutils data align-default" style="width: 100%;">
  <tr>
    <th rowspan="2" style="text-align: center; vertical-align: middle;">Arrow Type</th>
    <th colspan="2" style="text-align: center;">Microsoft SQL Server Type</th>
  </tr>
  <tr>
    <th style="text-align: center;">Bind</th>
    <th style="text-align: center;">Ingest</th>
  </tr>
<tr>
  <td>binary</td>
<td style="text-align: center;">

VARBINARY

</td>
<td style="text-align: center;">

VARBINARY(MAX)

</td>

</tr>
<tr>
  <td>binary_view</td>
<td style="text-align: center;">

VARBINARY

</td>
<td style="text-align: center;">

VARBINARY(MAX)

</td>

</tr>
<tr>
  <td>bool</td>


<td colspan="2" style="text-align: center;">

BIT

</td>

</tr>
<tr>
  <td>date32[day]</td>


<td colspan="2" style="text-align: center;">

DATE

</td>

</tr>
<tr>
  <td>decimal128</td>


<td colspan="2" style="text-align: center;">

NUMERIC

</td>

</tr>
<tr>
  <td>double</td>


<td colspan="2" style="text-align: center;">

DOUBLE PRECISION

</td>

</tr>
<tr>
  <td>fixed_size_binary</td>
<td style="text-align: center;">

VARBINARY

</td>
<td style="text-align: center;">

VARBINARY(MAX)

</td>

</tr>
<tr>
  <td>float</td>


<td colspan="2" style="text-align: center;">

REAL

</td>

</tr>
<tr>
  <td>halffloat</td>
<td style="text-align: center;">

REAL

</td>
<td style="text-align: center;">

(not tested)

</td>

</tr>
<tr>
  <td>int16</td>


<td colspan="2" style="text-align: center;">

SMALLINT

</td>

</tr>
<tr>
  <td>int32</td>


<td colspan="2" style="text-align: center;">

INT

</td>

</tr>
<tr>
  <td>int64</td>


<td colspan="2" style="text-align: center;">

BIGINT

</td>

</tr>
<tr>
  <td>large_binary</td>
<td style="text-align: center;">

VARBINARY

</td>
<td style="text-align: center;">

VARBINARY(MAX)

</td>

</tr>
<tr>
  <td>large_string</td>
<td style="text-align: center;">

NVARCHAR

</td>
<td style="text-align: center;">

NTEXT

</td>

</tr>
<tr>
  <td>string</td>
<td style="text-align: center;">

NVARCHAR

</td>
<td style="text-align: center;">

NTEXT

</td>

</tr>
<tr>
  <td>string_view</td>
<td style="text-align: center;">

NVARCHAR

</td>
<td style="text-align: center;">

NTEXT

</td>

</tr>
<tr>
  <td>time32[ms]</td>
<td style="text-align: center;">

TIME, TIME(1), TIME(2), TIME(3)

</td>
<td style="text-align: center;">

TIME(7) ⚠️ [^3]

</td>

</tr>
<tr>
  <td>time32[s]</td>
<td style="text-align: center;">

TIME, TIME(0)

</td>
<td style="text-align: center;">

TIME(7) ⚠️ [^3]

</td>

</tr>
<tr>
  <td>time64[ns]</td>
<td style="text-align: center;">

TIME, TIME(7)

</td>
<td style="text-align: center;">

TIME(7), TIME(7) ⚠️ [^3]

</td>

</tr>
<tr>
  <td>time64[us]</td>
<td style="text-align: center;">

TIME, TIME(4), TIME(5), TIME(6)

</td>
<td style="text-align: center;">

TIME(7) ⚠️ [^3]

</td>

</tr>
<tr>
  <td>timestamp[ms]</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[ms] (with time zone)</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[ns]</td>
<td style="text-align: center;">

DATETIME2 [^2]

</td>
<td style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[ns] (with time zone)</td>
<td style="text-align: center;">

DATETIME2 [^2]

</td>
<td style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[s]</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[s] (with time zone)</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[us]</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
<tr>
  <td>timestamp[us] (with time zone)</td>


<td colspan="2" style="text-align: center;">

DATETIME2

</td>

</tr>
</table>

## Previous Versions

To see documentation for previous versions of this driver, see the following:

- [v1.1.0](./v1.1.0.md)
- [v1.0.0](./v1.0.0.md)

[^1]: while the documentation claims 7 digits of precision, the client only receives 6

[^2]: Values rounded to microsecond precision

[^3]: ingested as TIME(7)

[mssql]: https://www.microsoft.com/sql-server
